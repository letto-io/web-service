<?xml version="1.0" encoding="utf-8"?>
<database xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://xsd.propelorm.org/1.6/database.xsd"
  name="default" defaultIdMethod="native" defaultPhpNamingMethod="underscore" namespace="BossEdu\Model">
  <table name="event">
    <column name="code" type="varchar" size="15" primaryKey="true" required="true" />
    <column name="name" type="varchar" size="100" required="true" />
    <column name="workload" type="decimal" size="7" scale="2" required="true" />
  </table>

  <table name="lecture">
    <column name="code" type="varchar" size="15" primaryKey="true" required="true" />
    <column name="name" type="varchar" size="100" required="true" />
    <column name="workload" type="decimal" size="7" scale="2" required="true" />
  </table>

  <table name="el_have">
    <column name="event_code" type="varchar" size="15" primaryKey="true" required="true" />
    <column name="lecture_code" type="varchar" size="15" primaryKey="true" required="true" />
    <foreign-key foreignTable="event" name="el_have_event_fk">
      <reference local="event_code" foreign="code" />
    </foreign-key>
    <foreign-key foreignTable="lecture" name="el_have_lecture_fk">
      <reference local="lecture_code" foreign="code" />
    </foreign-key>
  </table>

  <table name="schedule">
    <column name="weekday" type="integer" primaryKey="true" required="true" />
    <column name="start_time" type="time" primaryKey="true" required="true" />
    <column name="end_time" type="time" primaryKey="true" required="true" />
  </table>

  <table name="building">
    <column name="code" type="varchar" size="15" primaryKey="true" required="true" />
    <column name="description" type="varchar" size="100" />
  </table>

  <table name="room">
    <column name="building_code" type="varchar" size="15" primaryKey="true" required="true" />
    <column name="number" type="integer" primaryKey="true" required="true" />
    <column name="type" type="varchar" size="15" required="true" />
    <column name="capacity" type="integer" required="true" />
    <foreign-key foreignTable="building" name="room_building_fk">
      <reference local="building_code" foreign="code" />
    </foreign-key>
  </table>

  <table name="rs_available">
    <column name="building_code" type="varchar" size="15" primaryKey="true" required="true" />
    <column name="room_number" type="integer" primaryKey="true" required="true" />
    <column name="weekday" type="integer" primaryKey="true" required="true" />
    <column name="start_time" type="time" primaryKey="true" required="true" />
    <column name="end_time" type="time" primaryKey="true" required="true" />
    <column name="start_date" type="date" primaryKey="true" required="true" />
    <column name="end_date" type="date" required="true" />
    <foreign-key foreignTable="schedule" name="rs_available_schedule_fk">
      <reference local="weekday" foreign="weekday" />
      <reference local="start_time" foreign="start_time" />
      <reference local="end_time" foreign="end_time" />
    </foreign-key>
    <foreign-key foreignTable="room" name="rs_available_room_fk">
      <reference local="building_code" foreign="building_code" />
      <reference local="room_number" foreign="number" />
    </foreign-key>
  </table>

  <table name="someone">
    <column name="email" type="varchar" size="100" primaryKey="true" required="true" />
    <column name="password" type="varchar" size="16" required="true" />
    <column name="registration_date" type="date" defaultExpr="current_date" defaultValue="now"/>
    <column name="admin" type="boolean" defaultValue="false" />
  </table>

  <table name="instruction">
    <column name="id" type="integer" primaryKey="true" autoIncrement="true" required="true" />
    <column name="class" type="integer" defaultValue="1" />
    <column name="start_date" type="date" required="true" />
    <column name="end_date" type="date" required="true" />
    <column name="event_code" type="varchar" size="15" required="true" />
    <column name="lecture_code" type="varchar" size="15" required="true" />
    <foreign-key foreignTable="el_have" name="instruction_el_have_fk">
      <reference local="event_code" foreign="event_code" />
      <reference local="lecture_code" foreign="lecture_code" />
    </foreign-key>
    <unique name="instruction_uk">
      <unique-column name="class" />
      <unique-column name="start_date"/>
      <unique-column name="event_code"/>
      <unique-column name="lecture_code"/>
    </unique>
  </table>

  <table name="person">
    <column name="id" type="integer" primaryKey="true" autoIncrement="true" required="true" />
    <column name="document_name" type="varchar" size="30" />
    <column name="document_number" type="varchar" size="30" />
    <column name="name" type="varchar" size="100" required="true" />
    <column name="birth_date" type="date" />
    <column name="telephone" type="varchar" size="30" />
    <column name="country" type="varchar" size="30" />
    <column name="state" type="varchar" size="30" />
    <column name="town" type="varchar" size="100" />
    <column name="district" type="varchar" size="100" />
    <column name="street" type="varchar" size="100" />
    <column name="number" type="varchar" size="10" />
    <column name="email" type="varchar" size="100" required="true" />
    <foreign-key foreignTable="someone" name="person_user_fk">
      <reference local="email" foreign="email" />
    </foreign-key>
  </table>

  <table name="pi_link">
    <column name="instruction_id" type="integer" primaryKey="true" required="true" />
    <column name="person_id" type="integer" primaryKey="true" required="true" />
    <column name="profile" type="integer" defaultValue="1" />
    <foreign-key foreignTable="instruction" name="pi_link_instruction_fk">
      <reference local="instruction_id" foreign="id" />
    </foreign-key>
    <foreign-key foreignTable="person" name="pi_link_person_fk">
      <reference local="person_id" foreign="id" />
    </foreign-key>
  </table>

  <table name="isr_link">
    <column name="instruction_id" type="integer" primaryKey="true" required="true" />
    <column name="building_code" type="varchar" size="15" primaryKey="true" required="true" />
    <column name="room_number" type="integer" primaryKey="true" required="true" />
    <column name="weekday" type="integer" primaryKey="true" required="true" />
    <column name="start_time" type="time" primaryKey="true" required="true" />
    <column name="end_time" type="time" primaryKey="true" required="true" />
    <column name="start_date" type="date" primaryKey="true" required="true" />
    <foreign-key foreignTable="instruction" name="isr_link_instruction_fk">
      <reference local="instruction_id" foreign="id" />
    </foreign-key>
    <foreign-key foreignTable="rs_available" name="isr_link_rs_available_fk">
      <reference local="building_code" foreign="building_code" />
      <reference local="room_number" foreign="room_number" />
      <reference local="weekday" foreign="weekday" />
      <reference local="start_time" foreign="start_time" />
      <reference local="end_time" foreign="end_time" />
      <reference local="start_date" foreign="start_date" />
    </foreign-key>
  </table>

  <table name="mi_material">
    <column name="id" type="integer" primaryKey="true" autoIncrement="true" required="true" />
    <column name="name" type="varchar" size="50" required="true" />
    <column name="mime" type="varchar" size="50" required="true" />
    <column name="file" type="blob" required="true" />
    <column name="instruction_id" type="integer" required="true" />
    <foreign-key foreignTable="instruction" name="mi_material_instruction_fk">
      <reference local="instruction_id" foreign="id" />
    </foreign-key>
  </table>

  <table name="presentation">
    <column name="id" type="integer" primaryKey="true" autoIncrement="true" required="true" />
    <column name="status" type="integer" defaultValue="0" />
    <column name="subject" type="varchar" size="25" defaultValue="Class X" />
    <column name="created_at" type="timestamp" defaultExpr="current_timestamp(0)" defaultValue="now" />
    <column name="instruction_id" type="integer" required="true" />
    <column name="person_id" type="integer" required="true" />
    <foreign-key foreignTable="instruction" name="presentation_instruction_fk">
      <reference local="instruction_id" foreign="id" />
    </foreign-key>
    <foreign-key foreignTable="person" name="presentation_person_fk">
      <reference local="person_id" foreign="id" />
    </foreign-key>
  </table>

  <table name="mp_material">
    <column name="id" type="integer" primaryKey="true" autoIncrement="true" required="true" />
    <column name="name" type="varchar" size="50" required="true" />
    <column name="mime" type="varchar" size="50" required="true" />
    <column name="file" type="blob" required="true" />
    <column name="presentation_id" type="integer" required="true" />
    <foreign-key foreignTable="presentation" name="mp_material_presentation_fk">
      <reference local="presentation_id" foreign="id" />
    </foreign-key>
  </table>

  <table name="doubt">
    <column name="id" type="integer" primaryKey="true" autoIncrement="true" required="true" />
    <column name="status" type="integer" defaultValue="0" />
    <column name="text" type="varchar" size="140" required="true" />
    <column name="created_at" type="timestamp" defaultExpr="current_timestamp(0)" defaultValue="now"/>
    <column name="anonymous" type="boolean" defaultValue="false" />
    <column name="understand" type="boolean" defaultValue="false" />
    <column name="presentation_id" type="integer" required="true" />
    <column name="person_id" type="integer" required="true" />
    <foreign-key foreignTable="presentation" name="doubt_presentation_fk">
      <reference local="presentation_id" foreign="id" />
    </foreign-key>
    <foreign-key foreignTable="person" name="doubt_person_fk">
      <reference local="person_id" foreign="id" />
    </foreign-key>
  </table>

  <table name="pd_like">
    <column name="person_id" type="integer" primaryKey="true" required="true" />
    <column name="doubt_id" type="integer" primaryKey="true" required="true" />
    <column name="understand" type="boolean" defaultValue="false" />
    <foreign-key foreignTable="person" name="pd_like_person_fk">
      <reference local="person_id" foreign="id" />
    </foreign-key>
    <foreign-key foreignTable="doubt" name="pd_like_doubt_fk">
      <reference local="doubt_id" foreign="id" />
    </foreign-key>
  </table>

  <table name="contribution">
    <column name="id" type="integer" primaryKey="true" autoIncrement="true" required="true" />
    <column name="status" type="integer" defaultValue="0" />
    <column name="text" type="varchar" size="140" required="true" />
    <column name="created_at" type="timestamp" defaultExpr="current_timestamp(0)" defaultValue="now" />
    <column name="anonymous" type="boolean" defaultValue="false" />
    <column name="doubt_id" type="integer" defaultValue="false" required="true" />
    <column name="person_id" type="integer" defaultValue="false" required="true" />
    <foreign-key foreignTable="doubt" name="contribution_doubt_fk">
      <reference local="doubt_id" foreign="id" />
    </foreign-key>
    <foreign-key foreignTable="person" name="contribution_person_fk">
      <reference local="person_id" foreign="id" />
    </foreign-key>
  </table>

  <table name="mc_material">
    <column name="id" type="integer" primaryKey="true" autoIncrement="true" required="true" />
    <column name="name" type="varchar" size="50" required="true" />
    <column name="mime" type="varchar" size="50" required="true" />
    <column name="file" type="blob" required="true" />
    <column name="contribution_id" type="integer" required="true" />
    <foreign-key foreignTable="contribution" name="mc_material_contribution_fk">
      <reference local="contribution_id" foreign="id" />
    </foreign-key>
  </table>
</database>
